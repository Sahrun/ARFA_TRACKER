<!DOCTYPE html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Galery</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Free HTML5 Template by FREEHTML5.CO" />
		<meta name="keywords" content="free html5, free template, free bootstrap, html5, css3, mobile first, responsive" />
		<meta name="author" content="FREEHTML5.CO" />
		<meta property="og:title" content=""/>
		<meta property="og:image" content=""/>
		<meta property="og:url" content=""/>
		<meta property="og:site_name" content=""/>
		<meta property="og:description" content=""/>
		<meta name="twitter:title" content="" />
		<meta name="twitter:image" content="" />
		<meta name="twitter:url" content="" />
		<meta name="twitter:card" content="" />
		<link rel="shortcut icon" href="favicon.ico">
		<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
		
		<!-- Animate.css -->
		<link rel="stylesheet" href="../css/animate.css">
		<!-- Icomoon Icon Fonts-->
		<link rel="stylesheet" href="../css/icomoon.css">
		<!-- Bootstrap  -->
		<link rel="stylesheet" href="../css/bootstrap.css">
		<!-- Superfish -->
		<link rel="stylesheet" href="../css/superfish.css">
		<!-- Magnific Popup -->
		<link rel="stylesheet" href="../css/magnific-popup.css">
		<!-- Date Picker -->
		<link rel="stylesheet" href="../css/bootstrap-datepicker.min.css">
		<!-- CS Select -->
		<link rel="stylesheet" href="../css/cs-select.css">
		<link rel="stylesheet" href="../css/cs-skin-border.css">
		
		<link rel="stylesheet" href="../css/style.css">
		<!-- Modernizr JS -->
		<script src="../js/modernizr-2.6.2.min.js"></script>
		<!-- FOR IE9 below -->
		<!--[if lt IE 9]>
		<script src="js/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<div id="fh5co-wrapper">
			<div id="fh5co-page">
				<header id="fh5co-header-section" class="sticky-banner">
					<div class="container">
						<div class="nav-header">
							<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle dark"><i></i></a>
							<h1 id="fh5co-logo"><img src="../images/hiker.png" alt="Arfa logo" class="hidden-xs"><a href="index.html">arfa tracker</a></h1>
							<!-- START #fh5co-menu-wrap -->
							<nav id="fh5co-menu-wrap" role="navigation">
								<ul class="sf-menu" id="fh5co-primary-menu">
									<li><a href="index.html">Home</a></li>
									<li><a href="profil.html">Profile</a></li>
									<li><a href="blog.html">Blog</a></li>
									<li class="active"><a href="contact.html">Contact</a></li>
								</ul>
							</nav>
						</div>
					</div>
				</header>
				<!-- end:header-top -->
				<div>
					<div class="container">
						<div class="row">
							<div style="margin-top: 50px;" class="col-md-8 col-md-offset-2 text-center heading-section animate-box">
								<h3>Galery Information</h3>
								<table class="responstable">
								<thead>
									<tr>
										<th>No</th>
										<th>Name Galery</th>
										<th>Tanggal Upload</th>
										<th>Aksi</th>
									</tr>
								</thead>
									<tbody id="tableData">
										
									</tbody>
								</table>
								<div class="row">
									<button class="btn btn-primary" onclick="ClearForm()" data-toggle="modal" data-target="#modalform">Add Galery</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				
			</div>
			<!-- END fh5co-page -->
		</div>

		<div id="modalform" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Form Add Galery</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<form id="formgalery" class="form-horizontal">
						<div class="col-md-2">
						</div>
						<div class="col-md-8">
							<div class="form-group">
								<div class="col-md-4">
									<label for="name">Nama Galary</label>
								</div>
								<div class="col-md-8">
									<input type="text" name="nama_galery" id="nama_galery" class="form-control" placeholder="Nama Galery">
								</div>
							</div>
							<div class="form-group">
								<div class="col-md-4">
									<label for="Foto">Foto</label>
								</div>
								<div class="col-md-8">
									<input type="file" multiple name="Foto[]"  id="foto" onchange="RedFile(this)"  class="form-control" placeholder="Foto">
								</div>
							</div>
							<div class="form-group">
								<div class="col-md-4">
									<label for="Foto"></label>
								</div>
								<div class="col-md-8">
									<div id="detailGaleryForm"></div>
								</div>
							</div>
							<input type="text" name="proses" id="proses" hidden >
							<input type="text" name="idGalery" id="idGalery" hidden >
							<div class="form-group">
								<div class="col-md-4">
									<button id="save" class="btn btn-warning">Simpan</button>
									
								</div>
								
							</div>
						</div>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
			</div>
		</div>
	</div>
</div>


		<!-- END fh5co-wrapper -->
		<!-- jQuery -->
		<script src="../js/jquery.min.js"></script>
		<!-- jQuery Easing -->
		<script src="../js/jquery.easing.1.3.js"></script>
		<!-- Bootstrap -->
		<script src="../js/bootstrap.min.js"></script>
		<!-- Waypoints -->
		<script src="../js/jquery.waypoints.min.js"></script>
		<script src="../js/sticky.js"></script>
		<!-- Stellar -->
		<script src="../js/jquery.stellar.min.js"></script>
		<!-- Superfish -->
		<script src="../js/hoverIntent.js"></script>
		<script src="../js/superfish.js"></script>
		<!-- Magnific Popup -->
		<script src="../js/jquery.magnific-popup.min.js"></script>
		<script src="../js/magnific-popup-options.js"></script>
		<!-- Date Picker -->
		<script src="../js/bootstrap-datepicker.min.js"></script>
		<!-- CS Select -->
		<script src="../js/classie.js"></script>
		<script src="../js/selectFx.js"></script>
		<script src="../js/google_map.js"></script>
		
		<!-- Main JS -->
		<script src="../js/main.js"></script>
		<script type="text/javascript">
			GetData();
			$("#formgalery").on('submit',(function(e) {
				var data =new FormData(this);
				create(data);
				e.preventDefault();
			}));
			function create(data) {
				$.ajax({
			url: "../Service/Galery.php",
					type: "POST",
					data:  data,
					contentType: false,
			cache: false,
					processData:false,
					dataType: "json",
					success: function(data)
				{
					$("#modalform").modal('hide');
					GetData();
				},
					error: function()
				{
				alert("Terjadi Kesalahan");
					}
			});
			}
			function GetData() {
			$.ajax({
			url:"../Service/Galery.php", //the page containing php script
			type: "get", //request type,
			dataType: "json",
			data: {req:'GetDataGalery'},
			success: function(data) {
				$("#tableData").empty();
				$.each(data, function (i, item) {
			$("#tableData").append("<tr><td>"+(i+1)+"</td><td>"+item['name_galery']+"</td><td>"+item['upload_date']+"<td><a class='btn'><span class='glyphicon glyphicon-pencil' aria-hidden='true' data-toggle='modal' data-target='#modalform' onclick='GetGaleryByIdEdit("+item['id_galary']+")'></a> <a class='btn'><span class='glyphicon glyphicon-search' aria-hidden='true' data-toggle='modal' data-target='#modalViewDetail' onclick='GetGaleryById("+item['id_galary']+")'></span></a></td></tr>");
			});
			},
			error: function() {
			alert("Terjadi Kesalahan Silahkan Ulangi!");
			}
			});
			}
			function GetGaleryById(id) {
			$.ajax({
			url:"../Service/Galery.php", //the page containing php script
			type: "get", //request type,
			dataType: "json",
			data: {req:'GetDataGaleryById',id:id},
			success: function(data) {
				$("#nameGalery").html(data.galery['name_galery']);
					$("#detailGaleryView").empty();
				$.each(data.detailgalery, function (i, item) {
			$("#detailGaleryView").append("<div class='col-md-4'><img src='../images/Galery/"+item['foto']+"' class='img-thumbnail'></div>");
			});
			},
			error: function() {
			alert("Terjadi Kesalahan Silahkan Ulangi!");
			}
			});
			}
			function GetGaleryByIdEdit(id) {
			$.ajax({
			url:"../Service/Galery.php", //the page containing php script
			type: "get", //request type,
			dataType: "json",
			data: {req:'GetDataGaleryById',id:id},
			success: function(data) {
				$("#formgalery")[0].reset()
				$("#nama_galery").val(data.galery['name_galery']);
				$("#proses").val("update");
				$("#idGalery").val(data.galery['id_galary']);
					$("#detailGaleryForm").empty();
				$.each(data.detailgalery, function (i, item) {
			$("#detailGaleryForm").append("<div class='col-md-4'><img src='../images/Galery/"+item['foto']+"' class='img-thumbnail'></div>");
			});
			},
			error: function() {
			alert("Terjadi Kesalahan Silahkan Ulangi!");
			}
			});
			}
	    function RedFile(input){
	    $('#detailGaleryForm').empty();
		 if (input.files) {
        var reader = new FileReader();
        for (i = 0; i < input.files.length; i++) {
                var reader = new FileReader();
                reader.onload = function(e) {
                     $('#detailGaleryForm').append("<div class='col-md-4'><img src="+e.target.result+" class='img-thumbnail'></img></div>");
                }
        reader.readAsDataURL(input.files[i]);
         }
			}
		}
		function ClearForm(){
			$("#nama_galery").val("");
			$("#detailGaleryForm").empty();
			$("#foto").val("");
			$("#proses").val("input");
			$("#idGalery").val("");
		}
		</script>
	</body>
</html>

<div id="modalViewDetail" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Detail Galery</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="form-horizontal">
						<div class="col-md-2">
						</div>
						<div class="col-md-8">
							<div class="form-group">
								<label  class="col-md-6" for="name" class="label-control">Nama Galary : </label>
								<div class="col-md-6" >
									<label id="nameGalery" class="label-control"></label>
								</div>
							</div>
							<div class="form-group">
								<div class="col-md-4">
									<label for="Foto">Foto</label>
								</div>
							</div>
							<div class="form-group">
								<div class="col-md-12" id="detailGaleryView">
									
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
			</div>
		</div>
	</div>
</div>